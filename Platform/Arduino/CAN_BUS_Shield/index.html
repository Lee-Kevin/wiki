<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">

	<title>CAN-BUS Shield - Seeed Wiki</title>

        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../../css/highlight.css">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../../..">Seeed Wiki</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../../..">Home</a>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Platform <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Arduino</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../SeeeduinoV4.2/">Seeeduino V4.2</a>
</li>

        
            
<li class="active">
    <a href="./">CAN-BUS Shield</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Raspberry Pi</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../RaspberryPi/RaspberryPi/">Raspberry Pi</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Edison</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../Edison/Edison/">Intel Edison</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">LaunchPad</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../LaunchPad/LaunchPad/">TI LaunchPad</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">LinkIt</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../LinkIt/LinkIt_ONE/">LinkIt ONE</a>
</li>

        
            
<li >
    <a href="../../LinkIt/Breakout_for_LinkIt_Smart_7688_v2_0/">Breakout for LinkIt Smart 7688 V2.0</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">mbed</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../mbed/mbed/">mbed</a>
</li>

        
            
<li >
    <a href="../../mbed/Arch_BLE/">Arch BLE</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">RePhone</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../RePhone/RePhone/">RePhone</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Wio</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../Wio/Wio/">Wio</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Grove <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Sensor</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../Grove/Sensor/Grove_Barometer_Sensor_BMP280/">Grove - Barometer Sensor(BMP280)</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Actuator</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../Grove/Actuator/Actuator/">Actuator</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Display</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../Grove/Display/Display/">Display</a>
</li>

        
    </ul>
  </li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">Communication</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../Grove/Communication/Communication/">Communication</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">IoT <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../IoT/IoT/">IoT</a>
</li>

                        
                            
<li >
    <a href="../../../IoT/Microsoft_IoT_Grove_Kit/">Microsoft IoT Grove Kit</a>
</li>

                        
                            
<li >
    <a href="../../LinkIt/Breakout_for_LinkIt_Smart_7688_v2_0/">Breakout for LinkIt Smart 7688 V2.0</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorial <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../Tutorial/Tutorial/">Tutorial</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">SZ2U <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../SZ2U/SZ2U/">SZ2U</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../../about/">About</a>
</li>

                        
                            
<li >
    <a href="../../../Tutorial/update_wiki/">如何添加一篇文档</a>
</li>

                        
                            
  <li class="dropdown-submenu">
    <a tabindex="-1" href="">文档移植</a>
    <ul class="dropdown-menu">
        
            
<li >
    <a href="../../../Port/port_main/">需要做什么</a>
</li>

        
            
<li >
    <a href="../../../Port/port_review/">文档审核</a>
</li>

        
            
<li >
    <a href="../../../Port/port_github/">Github的使用</a>
</li>

        
            
<li >
    <a href="../../../Port/port_markdown/">Markdown</a>
</li>

        
            
<li >
    <a href="../../../Port/port_example/">一个例子</a>
</li>

        
            
<li >
    <a href="../../../Port/port_normal/">常用格式代码</a>
</li>

        
    </ul>
  </li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="../SeeeduinoV4.2/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../../RaspberryPi/RaspberryPi/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#can-bus-shield">CAN-BUS Shield</a></li>
        
            <li><a href="#introduction">Introduction</a></li>
        
            <li><a href="#features">Features</a></li>
        
            <li><a href="#hardware-overview">Hardware Overview</a></li>
        
            <li><a href="#getting-started">Getting Started</a></li>
        
            <li><a href="#apis">APIs</a></li>
        
            <li><a href="#generate-a-new-baudrate">Generate a New BaudRate</a></li>
        
            <li><a href="#projects">Projects</a></li>
        
            <li><a href="#resources">Resources</a></li>
        
            <li><a href="#is-this-page-helpful">Is this page helpful</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="can-bus-shield">CAN-BUS Shield<a class="headerlink" href="#can-bus-shield" title="Permanent link"></a></h1>
<hr />
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link"></a></h2>
<p><img alt="" src="https://github.com/SeeedDocument/CAN_BUS_Shield/blob/master/image/Can_bus_shield_all.jpg?raw=true" /></p>
<p><strong>CAN-BUS</strong> is a common industrial bus because of its long travel distance, medium communication speed and high reliability. It is commonly found on modern machine tools and as an automotive diagnostic bus. </p>
<p>This CAN-BUS Shield adopts <strong>MCP2515</strong> CAN Bus controller with SPI interface and <strong>MCP2551</strong> CAN transceiver to give your Arduino/Seeeduino CAN-BUS capibility. With an <strong>OBD-II</strong> converter cable added on and the OBD-II library imported, you are ready to build an onboard diagnostic device or data logger.</p>
<p><a href="http://www.seeedstudio.com/depot/CANBUS-Shield-V12-p-2256.html"><img alt="" src="https://raw.githubusercontent.com/SeeedDocument/Seeed-WiKi/master/docs/images/get_one_now.png" /></a></p>
<h2 id="features">Features<a class="headerlink" href="#features" title="Permanent link"></a></h2>
<ul>
<li>Implements CAN V2.0B at up to <strong>1 Mb/s</strong></li>
<li>SPI Interface up to <strong>10 MHz</strong></li>
<li>Standard (<strong>11 bit</strong>) and extended (<strong>29 bit</strong>) data and remote frames</li>
<li>Two receive buffers with prioritized message storage</li>
<li>Industrial standard DB-9 connector</li>
<li>LED indicators</li>
</ul>
<h2 id="hardware-overview">Hardware Overview<a class="headerlink" href="#hardware-overview" title="Permanent link"></a></h2>
<p><img alt="" src="https://github.com/SeeedDocument/CAN_BUS_Shield/blob/master/image/hardware_overview_1.png?raw=true" /></p>
<ol>
<li><strong>DB9 Interface</strong> - to connect to OBDII Interface via a DBG-OBD Cable.</li>
<li><strong>V_OBD</strong> - If get power from OBDII Interface(from DB9)</li>
<li><strong>Led Indicator</strong>:<ul>
<li><strong>PWR</strong>: power</li>
<li><strong>TX</strong>: blink when the data is sending</li>
<li><strong>RX</strong>: blink when there&rsquo;s data coming</li>
<li><strong>INT</strong>: data interrupt</li>
</ul>
</li>
<li><strong>Terminal</strong> - CAN_H and CAN_L</li>
<li><strong>Arduino UNO pin out</strong></li>
<li><strong>Serial Grove connector</strong></li>
<li><strong>I2C Grove connector</strong></li>
<li><strong>ICSP pins</strong></li>
<li><strong>IC</strong> - MCP2551, a high-speed can transceiver (<a href="https://github.com/SeeedDocument/CAN_BUS_Shield/raw/master/resource/Mcp2551.pdf">datasheet</a>)</li>
<li><strong>IC</strong> - MCP2515, stand-alone CAN controller wth SPI interface (<a href="https://github.com/SeeedDocument/CAN_BUS_Shield/raw/master/resource/MCP2515.pdf">datasheet</a>)</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When you use more than two CAN Bus Shield in one net, you should think about the impedance.
You can just cut P1 in the PCB with a knife, or just remove R3 on the PCB.</p>
</div>
<h3 id="pin-map">Pin map<a class="headerlink" href="#pin-map" title="Permanent link"></a></h3>
<p><img alt="" src="https://raw.githubusercontent.com/SeeedDocument/CAN_BUS_Shield/master/image/PINMAP.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The pin FREE is available for the others usage. </p>
</div>
<h3 id="db9obdii-interface">DB9&amp;OBDii Interface<a class="headerlink" href="#db9obdii-interface" title="Permanent link"></a></h3>
<p><img alt="" src="https://raw.githubusercontent.com/SeeedDocument/CAN_BUS_Shield/master/image/OBD.png" /></p>
<h3 id="cs-pin">CS pin<a class="headerlink" href="#cs-pin" title="Permanent link"></a></h3>
<p>SPI_CS pin of V1.2 is fefault to <strong>D9</strong>. If you want to change it to <strong>D10</strong>. Take a look at the back of the PCBA, you will find a pad named CS. You can cut the wire that at the left of the pad with a box cutter, and the solder the right 2 pads. </p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Be careful when you are going to change CS pin, it&rsquo;s easy to hear yourself or the PCBA.</p>
</div>
<p><img alt="" src="https://github.com/SeeedDocument/CAN_BUS_Shield/blob/master/image/hardware_overview_pins_setting.png?raw=true" /></p>
<h3 id="spi-pins">SPI pins<a class="headerlink" href="#spi-pins" title="Permanent link"></a></h3>
<p>The SPI pins(SCK, MISO, MOSI) is default to the ICSP pins. But for some Boards, maybe the SPI pins is at D11~D13, if so you need to change something in the PCBA. Take a look that the back of the PCBA, there&rsquo;re there pads, MOSI, MISO and SCK, they are default to A. You can change them to B if needed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For Arduino UNO, Arduino Mega, Arduino Leonardo and any others AVR based Arduino boards, default is working. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Be careful when you are going to change SPI pins, it&rsquo;s easy to hear yourself or the PCBA.</p>
</div>
<h2 id="getting-started">Getting Started<a class="headerlink" href="#getting-started" title="Permanent link"></a></h2>
<p>Here&rsquo;s a simple demo to show you how CAN-BUS Shield works. In this demo we need 2 piece of CAN-BUS Shield as well as Arduino/Seeeduino.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This demo is built under <a href="https://www.arduino.cc/download_handler.php?f=/arduino-1.6.9-windows.zip">Arduino IDE version 1.6.9</a>.</p>
</div>
<h3 id="step1-what-do-we-need">STEP1: What do we need<a class="headerlink" href="#step1-what-do-we-need" title="Permanent link"></a></h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Function</th>
<th>Qty</th>
<th>Link</th>
</tr>
</thead>
<tbody>
<tr>
<td>CAN-BUS Shield</td>
<td>CAN Bus communication</td>
<td>2</td>
<td><a href="http://www.seeedstudio.com/depot/CANBUS-Shield-V12-p-2256.html">link</a></td>
</tr>
<tr>
<td>Seeeduino V4.2</td>
<td>Controller</td>
<td>2</td>
<td><a href="http://www.seeedstudio.com/item_detail.html?p_id=2517">link</a></td>
</tr>
<tr>
<td>Jumper Wire</td>
<td>connection</td>
<td>2</td>
<td><a href="http://www.seeedstudio.com/item_detail.html?p_id=234">link</a></td>
</tr>
</tbody>
</table>
<h3 id="step2-hardware-connection">STEP2: Hardware Connection<a class="headerlink" href="#step2-hardware-connection" title="Permanent link"></a></h3>
<p>Insert each CAN-BUS Shield to Seeeduino V4.2, and connect the 2 CAN-BUS Shield togeter via 2 jumper wires. Shown as below images. </p>
<p><img alt="" src="https://raw.githubusercontent.com/SeeedDocument/CAN_BUS_Shield/master/image/connection.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>CAN_H to CAN_H, CAN_L to CAN_L</p>
</div>
<h3 id="step3-software">STEP3: Software<a class="headerlink" href="#step3-software" title="Permanent link"></a></h3>
<p>Click on the below button to download the library.</p>
<p><a href="https://github.com/Seeed-Studio/CAN_BUS_Shield"><img alt="" src="https://raw.githubusercontent.com/SeeedDocument/CAN_BUS_Shield/master/image/download_library.png" /></a></p>
<p>Install the library to your Arduino IDE when it is downloaded. </p>
<p>Of of the node(a node means Seeeduino + CAN_BUS Shield) act as master, the other act as slaver. The master will send data to slaver constantly. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Each node can act at master before the code is uploaded. </p>
</div>
<p>Open the <strong>send</strong> example (<strong>File &gt; Examples &gt; CAN_BUS_Shield-master &gt; send</strong>) and upload to the <strong>master</strong>. </p>
<p>Open the <strong>receive_check</strong> example (<strong>File &gt; Examples &gt; CAN_BUS_Shield-master &gt; receive_check</strong>) and upload to the <strong>slaver</strong>.</p>
<h3 id="step4-view-result">STEP4: View Result<a class="headerlink" href="#step4-view-result" title="Permanent link"></a></h3>
<p>Open the Serial Monitor of Arduino IDE(<strong>slaver</strong>), you will get the data sent from the master. </p>
<p><img alt="" src="https://raw.githubusercontent.com/SeeedDocument/CAN_BUS_Shield/master/image/serial_monitor.png" /></p>
<h2 id="apis">APIs<a class="headerlink" href="#apis" title="Permanent link"></a></h2>
<h3 id="1-set-the-baudrate">1. Set the Baudrate<a class="headerlink" href="#1-set-the-baudrate" title="Permanent link"></a></h3>
<p>This function is used to initialize the baudrate of the CAN Bus system.</p>
<p>The available baudrates are listed as follws:</p>
<pre><code>#define CAN_5KBPS    1
#define CAN_10KBPS   2
#define CAN_20KBPS   3
#define CAN_25KBPS   4 
#define CAN_31K25BPS 5
#define CAN_33KBPS   6
#define CAN_40KBPS   7
#define CAN_50KBPS   8
#define CAN_80KBPS   9
#define CAN_83K3BPS  10
#define CAN_95KBPS   11
#define CAN_100KBPS  12
#define CAN_125KBPS  13
#define CAN_200KBPS  14
#define CAN_250KBPS  15
#define CAN_500KBPS  16
#define CAN_666kbps  17
#define CAN_1000KBPS 18
</code></pre>
<h3 id="2-set-receive-mask-and-filter">2. Set Receive Mask and Filter<a class="headerlink" href="#2-set-receive-mask-and-filter" title="Permanent link"></a></h3>
<p>There are <strong>2</strong> receive mask registers and <strong>5</strong> filter registers on the controller chip that guarantee you get data from the target device. They are useful especially in a large network consisting of numerous nodes.</p>
<p>We provide two functions for you to utilize these mask and filter registers. They are:</p>
<p><strong>Mask:</strong></p>
<pre><code>init_Mask(unsigned char num, unsigned char ext, unsigned char ulData);
</code></pre>
<p><strong>Filter:</strong></p>
<pre><code>init_Filt(unsigned char num, unsigned char ext, unsigned char ulData);
</code></pre>
<ul>
<li><strong>num</strong> represents which register to use. You can fill 0 or 1 for mask and 0 to 5 for filter.</li>
<li><strong>ext</strong> represents the status of the frame. 0 means it&rsquo;s a mask or filter for a standard frame. 1 means it&rsquo;s for a extended frame.</li>
<li><strong>ulData</strong> represents the content of the mask of filter.</li>
</ul>
<h3 id="3-check-receive">3. Check Receive<a class="headerlink" href="#3-check-receive" title="Permanent link"></a></h3>
<p>The MCP2515 can operate in either a polled mode, where the software checks for a received frame, or using additional pins to signal that a frame has been received or transmit completed. </p>
<p>Use the following function to poll for received frames.</p>
<pre><code>INT8U MCP_CAN::checkReceive(void);
</code></pre>
<p>The function will return 1 if a frame arrives, and 0 if nothing arrives.</p>
<h3 id="4-get-can-id">4. Get CAN ID<a class="headerlink" href="#4-get-can-id" title="Permanent link"></a></h3>
<p>When some data arrive, you can use the following function to get the CAN ID of the &ldquo;send&rdquo; node.</p>
<pre><code>INT32U MCP_CAN::getCanId(void)
</code></pre>
<h3 id="5-send-data">5. Send Data<a class="headerlink" href="#5-send-data" title="Permanent link"></a></h3>
<pre><code>CAN.sendMsgBuf(INT8U id, INT8U ext, INT8U len, data_buf);
</code></pre>
<p>It is a function to send data onto the bus. In which:</p>
<ul>
<li><strong>id</strong> represents where the data come from.</li>
<li><strong>ext</strong> represents the status of the frame. &lsquo;0&rsquo; means standard frame. &lsquo;1&rsquo; means extended frame.</li>
<li><strong>len</strong> represents the length of this frame.</li>
<li><strong>data_buf</strong> is the content of this message.</li>
</ul>
<p>For example, In the &lsquo;send&rsquo; example, we have:</p>
<pre><code>unsigned char stmp[8] = {0, 1, 2, 3, 4, 5, 6, 7};
CAN.sendMsgBuf(0x00, 0, 8, stmp); //send out the message 'stmp' to the bus and tell other devices this is a standard frame from 0x00.
</code></pre>
<h3 id="6-receive-data">6. Receive Data<a class="headerlink" href="#6-receive-data" title="Permanent link"></a></h3>
<p>The following function is used to receive data on the &lsquo;receive&rsquo; node:</p>
<pre><code>CAN.readMsgBuf(unsigned char len, unsigned char buf);
</code></pre>
<p>In conditions that masks and filters have been set. This function can only get frames that meet the requirements of masks and filters.</p>
<ul>
<li><strong>len</strong> represents the data length.</li>
<li><strong>buf</strong> is where you store the data.</li>
</ul>
<h2 id="generate-a-new-baudrate">Generate a New BaudRate<a class="headerlink" href="#generate-a-new-baudrate" title="Permanent link"></a></h2>
<p>We had provided many frequently-used baud rate, as below:</p>
<pre><code>#define CAN_5KBPS    1
#define CAN_10KBPS   2
#define CAN_20KBPS   3
#define CAN_25KBPS   4 
#define CAN_31K25BPS 5
#define CAN_33KBPS   6
#define CAN_40KBPS   7
#define CAN_50KBPS   8
#define CAN_80KBPS   9
#define CAN_83K3BPS  10
#define CAN_95KBPS   11
#define CAN_100KBPS  12
#define CAN_125KBPS  13
#define CAN_200KBPS  14
#define CAN_250KBPS  15
#define CAN_500KBPS  16
#define CAN_666kbps  17
#define CAN_1000KBPS 18
</code></pre>
<p>Yet you may still can&rsquo;t find the rate you want. Here we provide a software to help you to calculate the baud rate you need.</p>
<p>Click <a href="https://github.com/SeeedDocument/CAN_BUS_Shield/raw/master/resource/CAN_Baudrate_CalcV1.3.zip">here</a> to download the software, it&rsquo;s in Chinese, but never mind, it&rsquo;s easy to use. </p>
<p><img alt="" src="https://github.com/SeeedDocument/CAN_BUS_Shield/blob/master/image/CAN_BUS_Shield_SetBaud.jpg?raw=true" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This software support Windows system only. If you can&rsquo;t open it, please free to contact loovee@seeed.cc for help. </p>
</div>
<p>Open the software, what you need to do is set the baud rate you want, and do some simple setting, then click <strong>calculate</strong>.</p>
<p>Then you will get some data, cfg1, cfg2 and cfg3.</p>
<p>You need to add some code to the library.</p>
<p>Open <strong>mcp_can_dfs.h</strong>, you need to add some code at about line 272:</p>
<pre><code>#define MCP_16MHz_xxxkBPS_CFG1 (cfg1)    // xxx is the baud rate you need
#define MCP_16MHz_xxxkBPS_CFG2 (cfg2)
#define MCP_16MHz_xxxkBPS_CFG3 (cfg2)
</code></pre>
<p>Then let&rsquo;s go to about line 390, add some code:</p>
<pre><code>#define CAN_xxxKBPS NUM       // xxx is the baudrate you need, and NUM is a number, you need to get a different from the other rates.
</code></pre>
<p>Open <strong>mcp_can.cpp</strong>, goto the function <strong>mcp2515_configRate</strong>(at about line 190), then add some code:</p>
<pre><code>case (CAN_xxxKBPS):
    cfg1 = MCP_16MHz_xxxkBPS_CFG1;
    cfg2 = MCP_16MHz_xxxkBPS_CFG2;
    cfg3 = MCP_16MHz_xxxkBPS_CFG3;
    break;
</code></pre>
<p>Then you can use the baud rate you need. And please give me a pull request at github when you use a new rate, so I can add it to the library to help the other guys.</p>
<h2 id="projects">Projects<a class="headerlink" href="#projects" title="Permanent link"></a></h2>
<p>If you want to make some awesome projects with CAN-BUS shield, here&rsquo;s some projects for reference.</p>
<h3 id="volkswagen-can-bus-gaming">Volkswagen CAN BUS Gaming<a class="headerlink" href="#volkswagen-can-bus-gaming" title="Permanent link"></a></h3>
<p><img alt="" src="https://github.com/SeeedDocument/CAN_BUS_Shield/blob/master/image/project1.JPG?raw=true" /></p>
<p>Ever wanted to play a car/truck simulator with a real dashboard on your PC? Me too! I&rsquo;m trying to control a VW Polo 6R dashboard via CAN Bus with an Arduino Uno and a Seeed CAN Bus Shield. Inspired by Silas Parker. Thanks to Sepp and Is0-Mick for their great support!</p>
<p><a href="http://www.seeed.cc/project_detail.html?id=291"><img alt="" src="https://github.com/SeeedDocument/CAN_BUS_Shield/blob/master/image/Wiki_makeitnow_logo.png?raw=true" /></a></p>
<h3 id="hack-your-vehicle-can-bus">Hack your vehicle CAN-BUS<a class="headerlink" href="#hack-your-vehicle-can-bus" title="Permanent link"></a></h3>
<p><img alt="" src="https://github.com/SeeedDocument/CAN_BUS_Shield/blob/master/image/project2.jpg?raw=true" /></p>
<p>Modern Vehicles all come equipped with a CAN-BUS Controller Area Network, Instead of having a million wires running back and forth from various devices in your car to the battery, its making use of a more clever system.</p>
<p>All electronic functions are connected to the TIPM, (Totally integrated Power Module), such as solenoids/relays to lock the doors or mini motors to wind the windows ect ect.</p>
<p>From each node (IE Switch pod that controls your windows or electric door locks) it broadcasts a message across the CAN. When the TIPM detects a valid message it will react accordingly like, lock the doors , switch on lights and so on.</p>
<p><a href="http://www.instructables.com/id/Hack-your-vehicle-CAN-BUS-with-Arduino-and-Seeed-C/"><img alt="" src="https://github.com/SeeedDocument/CAN_BUS_Shield/blob/master/image/Wiki_makeitnow_logo.png?raw=true" /></a></p>
<h2 id="resources">Resources<a class="headerlink" href="#resources" title="Permanent link"></a></h2>
<ul>
<li><strong>【PDF】</strong><a href="https://github.com/SeeedDocument/CAN_BUS_Shield/raw/master/resource/CAN-BUS_Shield_v1.2.pdf">CAN-BUS Shield V1.2 Schmatics</a></li>
<li><strong>【Eagle】</strong><a href="https://github.com/SeeedDocument/CAN_BUS_Shield/raw/master/resource/CAN-BUS_Shield_v1.2_sch_pcb.zip">Schematic of CAN-BUS Shield V1.2</a> </li>
<li><strong>【Library】</strong><a href="https://github.com/Seeed-Studio/CAN_BUS_Shield">Arduino Library for CAN-BUS Shield</a></li>
<li><strong>【Datasheet】</strong><a href="https://github.com/SeeedDocument/CAN_BUS_Shield/raw/master/resource/MCP2515.pdf">MCP2515 datasheet</a></li>
<li><strong>【Datasheet】</strong><a href="https://github.com/SeeedDocument/CAN_BUS_Shield/raw/master/resource/Mcp2551.pdf">MCP2551 datasheet</a></li>
<li><strong>【Demo】</strong><a href="https://github.com/Seeed-Studio/CANBUS_SHIELD_OBD_RECIPLE">An OBD Demo</a></li>
<li>【<strong>Tool】</strong><a href="https://github.com/SeeedDocument/CAN_BUS_Shield/raw/master/resource/CAN_Baudrate_CalcV1.3.zip">MCP2515 Baud Rate Tool</a></li>
</ul>
<h2 id="is-this-page-helpful">Is this page helpful<a class="headerlink" href="#is-this-page-helpful" title="Permanent link"></a></h2>
<p><iframe style="height: 600px; width: 500px; margin: 10px 0 10px;" allowTransparency="true" src="https://www.surveymonkey.com/r/32WG3KT" frameborder="0"></iframe></p></div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        <script src="../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/highlight.pack.js"></script>
        <script>var base_url = '../../..';</script>
        <script data-main="../../../mkdocs/js/search.js" src="../../../mkdocs/js/require.js"></script>
        <script src="../../../js/base.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>

    </body>
</html>
